<!DOCTYPE html>
<html layout:decorate="~{/layout}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Question List</title>
  <link rel="stylesheet" type="text/css" th:href="@{/style.css}">
  <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
</head>
<body>
<div layout:fragment="content" class="container my-3">
  <table class="table">
    <thead class="table-dark">
    <tr>
      <th>번호</th>
      <th>제목</th>
      <th>작성일시</th>
      <th>설정</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="board, loop : ${paging}">
      <td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>
      <td>
        <a th:href="@{|/board/detail/${board.id}|}" th:text="${board.title}"></a>
        <span class="text-danger small ms-2"
              th:if="${#lists.size(board.answerList) > 0}"
              th:text="${#lists.size(board.answerList)}">
                </span>
      </td>
      <td th:text="${#temporals.format(board.createDate, 'yyyy-MM-dd HH:mm')}"></td>
      <td>
        <a href="javascript:void(0)" th:data-uri="@{|/setting/delete/${board.id}|}"
           class="delete btn btn-primary my-2">삭제</a>
        <a th:href="@{|/setting/modify/${board.id}|}" class="btn btn-primary my-2">수정</a>
        <a href="#" th:onclick="javascript:copy(); return false;" class="btn btn-primary my-2">링크</a>

        <a href="#">팔로우</a>

        <a id="btnTwitter" class="link-icon twitter" href="javascript:shareTwitter();">트위터</a>
        <a id="btnKakao" class="link-icon kakao" href="javascript:sendLinkDefault();">카카오톡</a>
      </td>
    </tr>
    </tbody>
  </table>
  <!-- 페이징처리 시작 -->
  <div th:if="${!paging.isEmpty()}">
    <ul class="pagination justify-content-center">
      <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
        <a class="page-link"
           th:href="@{|?page=${paging.number-1}|}">
          <span>이전</span>
        </a>
      </li>
      <li th:each="page: ${#numbers.sequence(0, paging.totalPages-1)}"
          th:if="${page >= paging.number-5 and page <= paging.number+5}"
          th:classappend="${page == paging.number} ? 'active'"
          class="page-item">
        <a th:text="${page}" class="page-link" th:href="@{|?page=${page}|}"></a>
      </li>
      <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
        <a class="page-link" th:href="@{|?page=${paging.number+1}|}">
          <span>다음</span>
        </a>
      </li>
    </ul>
  </div>
  <!-- 페이징처리 끝 -->
  <a th:href="@{/board/create}" class="btn btn-primary">질문 등록하기</a>
</div>

<!-- 자바스크립트 -->
<script layout:fragment="script" type='text/javascript'>
const delete_elements = document.getElementsByClassName("delete");
Array.from(delete_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        if(confirm("정말로 삭제하시겠습니까?")) {
            location.href = this.dataset.uri;
        };
    });
});

function copy(){
    var url = ' ';
    var dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    url = window.document.location.href;
    dummy.value = url;
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);
    alert("URL이 클립보드에 복사되었습니다");
}






</script>

</body>
</html>